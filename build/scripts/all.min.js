!function(){angular.module("app",["ngRoute","ngSanitize"])}(),function(){function t(t,e){function i(t,e){return{request:function(e){return e.url.indexOf("api.spotify")>-1&&(e.headers.Authorization="Bearer "+t.localStorage.getItem("authToken")),e},responseError:function(t){if("401"==t.status&&t.config.url.indexOf("api.spotify")>-1){var i=e.get("spotify");i.logout()}return t}}}t.when("/home",{templateUrl:"app/home/home.html",controller:"homeController",controllerAs:"vm"}).when("/playlist/:ownerId/:playlistId",{templateUrl:"app/playlist/playlist.html",controller:"playlistController",controllerAs:"vm"}).when("/",{templateUrl:"app/login/login.html",controller:"loginController",controllerAs:"vm"}).when("/:access_token",{templateUrl:"app/login/login.html",controller:"loginController",controllerAs:"vm"}).otherwise("/"),i.$inject=["$window","$injector"],e.interceptors.push(i)}var e=angular.module("app");e.config(t),t.$inject=["$routeProvider","$httpProvider"]}(),function(){function t(){function t(t,e){function i(t){var e=$(window).scrollTop()+$(window).height(),i=$(t).offset().top+$(t).height();return i-.5*$(t).height()<=e&&$(t).offset().top>=$(window).scrollTop()}$(window).scroll(function(){i(e)?e.removeClass("partial"):e.addClass("partial")})}return{link:t}}angular.module("app").directive("cwFade",t),t.$inject=[]}(),function(){function t(t){return{restrict:"E",templateUrl:"./app/directives/templates/spotifyPlay.html",scope:{song:"="},link:function(e){e.url=t.trustAsResourceUrl("https://embed.spotify.com/?uri="+e.song.uri)}}}angular.module("app").directive("cwSpotifyPlay",t),t.$inject=["$sce"]}(),function(){function t(t){var e=this;e.user=t.user,e.playlists=[],e.logout=t.logout,t.getPlaylists().then(function(t){e.playlists=t})}angular.module("app").controller("homeController",t),t.$inject=["spotify"]}(),function(){function t(t,e){function i(){window.location="https://accounts.spotify.com/en/authorize?client_id=cf218c95b88e409fbdd30b815632bd14&response_type=token&redirect_uri=http://localhost:7203/#/&scope=user-read-private%20playlist-read-private"}var o=this;o.login=i,t.absUrl().indexOf("/access_token")>-1&&(window.location=t.absUrl().replace("access_token","?access_token")),t.search().access_token&&(e.setToken(t.search().access_token),e.login().then(function(){t.url("/home")}))}angular.module("app").controller("loginController",t),t.$inject=["$location","spotify"]}(),function(){function t(t,e,i){var o=this;o.title="playlist";var a=i.playlistId,n=i.ownerId;t.getPlaylist(n,a).then(function(t){o.playlist=t,angular.forEach(o.playlist.tracks.items,function(t){e.getVideo(t.track.name).then(function(e){t.video=e})})})}angular.module("app").controller("playlistController",t),t.$inject=["spotify","youtube","$routeParams"]}(),function(){function t(t,e,i){function o(){return t.get("https://api.spotify.com/v1/me").then(function(t){c.user.id=t.data.id,c.user.name=t.data.display_name,e.localStorage.setItem("spotify",JSON.stringify(c.user))})}function a(){e.localStorage.removeItem("authToken"),e.localStorage.removeItem("spotify"),c.user={},i.path("")}function n(t){e.localStorage.setItem("authToken",t)}function l(e){return t.get("spotify"+e).then(function(t){return t.data})}function r(){return t.get("https://api.spotify.com/v1/users/"+c.user.id+"/playlists").then(function(t){return t.data.items})}function s(e,i){return t.get("https://api.spotify.com/v1/users/"+e+"/playlists/"+i).then(function(t){return t.data})}var c={getPlaylists:r,getPlaylist:s,getSong:l,login:o,logout:a,setToken:n,user:{}};return e.localStorage.getItem("spotify")&&(c.user=JSON.parse(e.localStorage.getItem("spotify"))),c}angular.module("app").factory("spotify",t),t.$inject=["$http","$window","$location"]}(),function(){function t(t){function e(e){return t.get("https://content.googleapis.com/youtube/v3/search?safeSearch=strict&part=snippet&q="+e+"&key=AIzaSyAjfOZ77iVJbiIhcegRuFDNkug-sNA3izo").then(function(t){var e={};return angular.forEach(t.data.items,function(t){t.snippet.channelTitle.toLowerCase().indexOf("vevo")>0&&(e.id=t.id.videoId,e.title=t.snippet.title,e.thumbnail=t.snippet.thumbnails["default"].url)}),e})}var i={getVideo:e};return i}angular.module("app").factory("youtube",t),t.$inject=["$http"]}(),angular.module("app").run(["$templateCache",function(t){t.put("app/home/home.html",'<h4><div ng-click=vm.logout()><i class="fa fa-sign-out"></i> Logout</div></h4><h4>Welcome {{vm.user.name}}</h4><div class=container><div class=row><div ng-repeat="playlist in vm.playlists" class="playlist col-xs-4" cw-fade=""><a href=/#/playlist/{{playlist.owner.id}}/{{playlist.id}}><img ng-src={{playlist.images[0].url}}><div class=playlist-name>{{playlist.name}}</div></a></div></div></div>'),t.put("app/login/login.html",'<div class=container><div class=row><div class="col-xs-4 col-xs-push-4 login text-center" ng-click=vm.login()><h4>Login with Spotify</h4><i class="fa fa-4x fa-spotify"></i></div></div></div>'),t.put("app/music/music.html","<!DOCTYPE html><html><head lang=en><meta charset=UTF-8><title></title></head><body></body></html>"),t.put("app/playlist/playlist.html",'<h4><a href=/#/home><i class="fa fa-chevron-left"></i> Back</a></h4><h4>{{vm.playlist.name}}</h4><div class=container><div class=row><div ng-repeat="item in vm.playlist.tracks.items" class="song col-xs-4" cw-fade=""><span class=artist>{{item.track.artists[0].name}}</span> <span class=track>{{item.track.name}}</span> <img ng-src={{item.track.album.images[0].url}}> <a href={{item.track.album.external_urls.spotify}} target=_blank><i class="fa fa-spotify"></i> Listen on Spotify</a> <a ng-show=item.video.id href="{{\'https://www.youtube.com/watch?v=\' + item.video.id}}" target=_blank><i class="fa fa-youtube-play"></i> Watch on youtube</a></div></div></div>'),t.put("app/directives/templates/spotifyPlay.html","<iframe ng-src={{url}} width=100% height=100 frameborder=0 allowtransparency=true></iframe>")}]);
//# sourceMappingURL=all.min.js.map